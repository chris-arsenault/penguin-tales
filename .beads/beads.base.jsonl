{"id":"penguin-tales-3ap","title":"Gaussian Cluster placement","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T20:43:59.822537282-07:00","updated_at":"2025-11-26T20:51:28.632954856-07:00","closed_at":"2025-11-26T20:51:28.632954856-07:00"}
{"id":"penguin-tales-3tx","title":"Move loreIndex.ts and loreValidator.ts to domain","description":"These files contain penguin-specific hardcoded data and should be in penguin-tales/lore/ not in framework","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T05:13:16.336766817-07:00","updated_at":"2025-11-28T05:15:13.31039671-07:00","closed_at":"2025-11-28T05:15:13.31039671-07:00"}
{"id":"penguin-tales-ds5","title":"Organize lore-weave lib structure","description":"lib/config/tagRegistry.ts and feedbackLoops.ts contain both framework utilities (getTagMetadata, validateEntityTags, FeedbackAnalyzer) and domain-specific data (penguin tags like orca/colony/fishing, hero/conflict feedback loops). Needs split: framework keeps interfaces and utility functions, domain provides data via DomainSchema config. This is part of a3l epic.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T11:34:48.556454833-07:00","updated_at":"2025-11-28T05:08:13.580560752-07:00","closed_at":"2025-11-28T05:08:13.580560752-07:00"}
{"id":"penguin-tales-otn","title":"Poisson Disk Sampling algorithm","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T20:43:55.347473754-07:00","updated_at":"2025-11-26T20:50:07.296512747-07:00","closed_at":"2025-11-26T20:50:07.296512747-07:00"}
{"id":"penguin-tales-kml","title":"Name uniqueness enforcement - 46 duplicate names in generated world","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T09:59:18.367067766-07:00","updated_at":"2025-11-28T10:25:08.533045424-07:00","closed_at":"2025-11-28T10:25:08.533045424-07:00"}
{"id":"penguin-tales-pnj.4","title":"Update domain systems to be culturally aware","description":"Update all penguin domain systems to consider culture in their mechanics.\n\n**DONE:**\n- relationshipFormation.ts - Added sameCultureMultiplier (1.5x), differentCulturePenalty (0.4x), crossCultureRomancePenalty (0.2x)\n  - Friendships/rivalries boosted for same-culture NPCs\n  - Conflicts more likely between different cultures\n  - Romance strongly culture-dependent\n\n**REMAINING:**\n- culturalDrift.ts - Use entity.culture field, not just tags\n- Meta-entity formation systems (magicSchoolFormation, combatTechniqueFormation, legalCodeFormation) - Prefer same-culture clustering\n- New system: culturalAssimilation.ts - Entities assimilate when surrounded by different culture","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T14:59:39.085045783-07:00","updated_at":"2025-11-28T15:15:11.014107085-07:00","closed_at":"2025-11-28T15:15:11.014107085-07:00"}
{"id":"penguin-tales-a3l.2","title":"Move loreValidator hardcoded terms to DomainLoreProvider","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T05:37:39.75295676-07:00","updated_at":"2025-11-28T05:39:19.006649321-07:00","closed_at":"2025-11-28T05:39:19.006649321-07:00"}
{"id":"penguin-tales-emm","title":"Penguin domain default placements","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T20:44:03.129268603-07:00","updated_at":"2025-11-26T20:51:28.621560367-07:00","closed_at":"2025-11-26T20:51:28.621560367-07:00"}
{"id":"penguin-tales-brq","title":"Create domain interface for entity relationship helpers","description":"Analysis from 8oh: helpers.ts has getLocation, getFactionMembers, getFactionLeader, getCoreFactionMembers, getFactionRelationship called from BOTH domain AND framework code (templateGraphView.ts, metaEntityFormation.ts). Fix: 1) Define domain interface for these operations, 2) Move implementations to domain, 3) Framework calls via interface.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T04:31:40.425189818-07:00","updated_at":"2025-11-28T04:44:13.998370422-07:00","closed_at":"2025-11-28T04:44:13.998370422-07:00"}
{"id":"penguin-tales-8oh","title":"Remove domain-specific code from helpers.ts","notes":"Analysis complete. Domain-specific functions in helpers.ts: getLocation, getFactionMembers, getFactionLeader, getCoreFactionMembers, getFactionRelationship. These are ALSO called from framework code (templateGraphView.ts, metaEntityFormation.ts) creating tight coupling. Proper fix requires: 1) Define domain interface for entity relationships, 2) Move helpers to domain layer, 3) Framework calls domain via interface. This is part of larger framework/domain separation (a3l).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-27T11:12:49.595661607-07:00","updated_at":"2025-11-28T04:27:17.181132982-07:00","closed_at":"2025-11-28T04:27:17.181140592-07:00"}
{"id":"penguin-tales-gzf","title":"Test validation system on example domains","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T08:27:01.42053294-07:00","updated_at":"2025-11-24T08:35:09.006310325-07:00","closed_at":"2025-11-24T08:35:09.006310325-07:00","dependencies":[{"issue_id":"penguin-tales-gzf","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T08:27:01.42106188-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-5e5","title":"Build CLI interface with commander","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T07:48:40.95996403-07:00","updated_at":"2025-11-24T08:03:54.105434425-07:00","closed_at":"2025-11-24T08:03:54.105434425-07:00","dependencies":[{"issue_id":"penguin-tales-5e5","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T07:48:40.960659043-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-f3e","title":"Replace custom algorithms with library implementations","description":"Based on research in penguin-tales-3qn, replace custom implementations with battle-tested libraries:\n\n1. **turf.js** - Replace geometry functions in regionMapper.ts\n2. **simple-statistics** - Replace stats in distributionCalculations.ts, statisticsCollector.ts  \n3. **Fix shuffle bug** - helpers.ts uses broken sort-based shuffle\n\nStart with the shuffle bug fix (easiest, highest impact on correctness).","notes":"Completed: 1) Fixed biased shuffle with Fisher-Yates, 2) Replaced variance/stdDev in statisticsCollector.ts with simple-statistics, 3) turf.js not applicable (3D coords vs 2D geo)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T04:05:50.058225581-07:00","updated_at":"2025-11-28T04:09:26.696716133-07:00","closed_at":"2025-11-28T04:09:26.696721728-07:00"}
{"id":"penguin-tales-kr7","title":"Framework/Domain Separation: Define framework-level primitives","description":"Define the minimal set of primitives that the framework needs to operate:\n\n**Framework Entity Kinds:**\n- era - Required for era transition system\n\n**Framework Relationship Kinds:**\n- part_of - Hierarchical composition (meta-entities, structural)\n- supersedes - Temporal succession (era transitions)\n- active_during - Entity-era temporal binding\n\n**Framework Status Values:**\n- historical - Archived entity/relationship\n- active - Generic active state\n\n**Implementation:**\n1. Create apps/lore-weave/lib/types/frameworkPrimitives.ts\n2. Define constants and type guards\n3. Update framework code to use these constants instead of string literals\n4. Document which primitives are framework vs domain","notes":"Completed: Converted framework code to use FRAMEWORK_ENTITY_KINDS, FRAMEWORK_STATUS, FRAMEWORK_RELATIONSHIP_KINDS constants. Updated 8 files: eraTransition.ts, eraSpawner.ts, occurrenceCreation.ts, universalCatalyst.ts, catalystHelpers.ts, worldEngine.ts, enrichmentService.ts, frameworkPrimitives.ts. Added documentation to CLAUDE.md about framework primitives. Note: Test failures pre-exist (mock graph missing methods).","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-26T09:44:23.055536711-07:00","updated_at":"2025-11-28T04:26:36.349582817-07:00","closed_at":"2025-11-28T04:26:36.349588308-07:00"}
{"id":"penguin-tales-a3l.1","title":"Move tagRegistry to domain","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T05:26:26.997846039-07:00","updated_at":"2025-11-28T05:34:16.534566208-07:00","closed_at":"2025-11-28T05:34:16.534566208-07:00"}
{"id":"penguin-tales-e60","title":"Implement Generalized Coordinate System","description":"Implement unified 6-axis coordinate template (plane, sector_x, sector_y, cell_x, cell_y, z_band) for all entity types.\n\nKey Design:\n- Required coordinates field on HardState (not optional)\n- Eager assignment - templates must assign at creation\n- Physical space first - locations/NPCs\n- Cross-kind distance in shared spaces\n\nReference: COORDINATES.md, plan at ~/.claude/plans/mellow-dancing-feather.md","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-26T19:29:55.361938399-07:00","updated_at":"2025-11-26T19:46:06.080583785-07:00","closed_at":"2025-11-26T19:46:06.080583785-07:00"}
{"id":"penguin-tales-xx6.1","title":"Create clusteringUtils.ts with generic clustering functions","description":"Create apps/lore-weave/lib/utils/clusteringUtils.ts:\n\n- clusterEntities(graph, config): Cluster[] - Generic greedy clustering\n- ClusterConfig interface with similarity callback\n- Cluster interface (entities, score)\n- Domain provides similarity function instead of hardcoded criteria types","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T09:45:05.883839811-07:00","updated_at":"2025-11-26T09:49:33.762196776-07:00","closed_at":"2025-11-26T09:49:33.762201237-07:00"}
{"id":"penguin-tales-a3l.3","title":"Move imageGenerationService prompts to domain config","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-28T05:40:16.677877692-07:00","updated_at":"2025-11-28T14:32:10.881690886-07:00","closed_at":"2025-11-28T14:32:10.881690886-07:00"}
{"id":"penguin-tales-izu","title":"Move occurrence relationship kinds to domain config","description":"Analysis from rgj: occurrenceCreation.ts hardcodes 'participant_in', 'epicenter_of', 'triggered_by' relationship kinds. Options: 1) Add to FRAMEWORK_RELATIONSHIP_KINDS if universal, 2) Move to domain config via graph.config.domain, 3) Move entire occurrenceCreation system to domain layer.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T04:31:40.756121097-07:00","updated_at":"2025-11-28T04:41:18.200314594-07:00","closed_at":"2025-11-28T04:41:18.200314594-07:00"}
{"id":"penguin-tales-ti1","title":"Remove remaining domain refs from metaEntityFormation.ts","description":"metaEntityFormation.ts references domain-specific subtypes and relationship kinds. Already deprecated but cleanup needed.","notes":"Found: metaEntityFormation.ts has createGovernanceFaction() creating 'faction:political' entities with hardcoded subtypes/relationships ('controls', 'weaponized_by'). Domain also has its own version in legalCodeFormation.ts. Fix: 1) Remove createGovernanceFaction from framework metaEntityFormation.ts, 2) Rely solely on domain's legalCodeFormation.ts. Controlled by config.transformation.createGovernanceFaction flag.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T10:09:32.792623878-07:00","updated_at":"2025-11-28T04:28:24.904014483-07:00","closed_at":"2025-11-28T04:28:24.904020134-07:00"}
{"id":"penguin-tales-7si","title":"Parameterize emergentDiscovery.ts via domain schema","description":"emergentDiscovery.ts has hardcoded subtypes (colony, anomaly) and status values (thriving, waning). Parameterize via domain schema.","notes":"Analysis: emergentDiscovery.ts partially parameterized. 'thrivingStatuses'/'strugglingStatuses' already come from config via requireConfigValue(). Remaining hardcoded: 'anomaly' subtype (lines 192, 309) for location entities. Fix: Add 'anomalySubtype' config field and read via requireConfigValue().","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T10:09:32.783291414-07:00","updated_at":"2025-11-28T04:28:53.025461299-07:00","closed_at":"2025-11-28T04:28:53.025466185-07:00"}
{"id":"penguin-tales-54g","title":"Setup namegen-validation package structure","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T08:27:00.039785966-07:00","updated_at":"2025-11-24T08:28:43.814800205-07:00","closed_at":"2025-11-24T08:28:43.814800205-07:00","dependencies":[{"issue_id":"penguin-tales-54g","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T08:27:00.040420771-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-fxx","title":"Create example domain configs and test generation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T07:48:41.891995966-07:00","updated_at":"2025-11-24T08:09:44.786898092-07:00","closed_at":"2025-11-24T08:09:44.786898092-07:00","dependencies":[{"issue_id":"penguin-tales-fxx","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T07:48:41.89270697-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-ez9","title":"Extract relationship config from helpers.ts to domain schema","description":"helpers.ts has 400+ lines of hardcoded relationship mappings (strengths, categories, conflicts, thresholds). Move to DomainSchema.","notes":"Extended DomainSchema with RelationshipConfig, RelationshipLimits, RelationshipCategory types. Updated penguin schema with strength, category, isLineage, distanceRange, conflictsWith. Updated helpers.ts to use domain schema methods with fallback.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T10:09:32.752856186-07:00","updated_at":"2025-11-26T10:21:54.128472935-07:00","closed_at":"2025-11-26T10:21:54.128477016-07:00"}
{"id":"penguin-tales-6gw","title":"Anchor and Centroid Co-location","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T20:43:56.158113572-07:00","updated_at":"2025-11-26T20:50:07.307916367-07:00","closed_at":"2025-11-26T20:50:07.307916367-07:00"}
{"id":"penguin-tales-mm5","title":"Implement phonology generator (syllable templates, phoneme selection)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T07:48:40.077497256-07:00","updated_at":"2025-11-24T08:00:18.165056066-07:00","closed_at":"2025-11-24T08:00:18.165056066-07:00","dependencies":[{"issue_id":"penguin-tales-mm5","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T07:48:40.078249127-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-3se","title":"addEntityWithPlacement API","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T20:44:02.25592643-07:00","updated_at":"2025-11-26T20:50:07.322841045-07:00","closed_at":"2025-11-26T20:50:07.322841045-07:00"}
{"id":"penguin-tales-pnj","title":"Culture-First Framework Enhancement","description":"Make culture a first-class mechanic, not just a data field. Culture should drive decisions in templates, systems, and pressures - not just naming and visuals.\n\n**Current State:**\n- Culture is stored on entities but ignored by most mechanics\n- Cross-culture relationships form identically to same-culture\n- Templates copy culture but don't branch on it\n- Pressures measure fragmentation, not actual cultural state\n\n**Goal:**\n- Templates branch on culture to create culture-specific variants\n- Systems prefer same-culture relationships and penalize cross-culture\n- Pressures measure actual cultural alignment/divergence\n- Framework provides tools to detect culture-ignorant domain code","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-28T14:58:47.605583178-07:00","updated_at":"2025-11-28T15:15:18.488675188-07:00","closed_at":"2025-11-28T15:15:18.488675188-07:00"}
{"id":"penguin-tales-1zo","title":"Exclusion-Aware wrapper","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T20:43:58.981354823-07:00","updated_at":"2025-11-26T20:50:07.315509651-07:00","closed_at":"2025-11-26T20:50:07.315509651-07:00"}
{"id":"penguin-tales-xx6.5","title":"Remove MetaEntityFormation service and MetaEntityConfig","description":"After converting to system pattern:\n\n1. Remove apps/lore-weave/lib/services/metaEntityFormation.ts\n2. Remove MetaEntityConfig from apps/lore-weave/lib/types/engine.ts\n3. Remove metaEntityConfigs from EngineConfig\n4. Remove checkMetaEntityFormation() from worldEngine.ts\n5. Update index.ts exports\n6. Remove from penguin main.ts config","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T09:45:18.951884243-07:00","updated_at":"2025-11-26T09:57:27.613786662-07:00","closed_at":"2025-11-26T09:57:27.613791102-07:00"}
{"id":"penguin-tales-dla","title":"Define Zod schemas for domain configs (PhonologyProfile, MorphologyProfile, StyleRules)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T07:48:39.936097595-07:00","updated_at":"2025-11-24T07:58:55.042102565-07:00","closed_at":"2025-11-24T07:58:55.042102565-07:00","dependencies":[{"issue_id":"penguin-tales-dla","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T07:48:39.93674594-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-pnj.3","title":"Update domain templates to be culturally aware","description":"Update all penguin domain templates to consider culture in their decisions.\n\n**DONE:**\n- cultFormation.ts - Added sameCultureAs preference, differentCulturePenalty (0.3) for cultist recruitment\n- guildEstablishment.ts - Added sameCultureAs preference, differentCulturePenalty (0.2) for guild membership\n\n**PATTERN ESTABLISHED:**\n```typescript\nconst result = graphView.selectTargets('npc', count, {\n  prefer: {\n    sameCultureAs: location.culture, // Prefer same-culture recruits\n    preferenceBoost: 2.0\n  },\n  avoid: {\n    differentCulturePenalty: 0.3 // Cross-culture is rare\n  }\n});\n```\n\n**REMAINING:**\n- heroEmergence.ts - Branch on culture for hero archetype\n- familyExpansion.ts - sameCultureAs for family members\n- kinshipConstellation.ts - Same-culture kinship networks\n- factionSplinter.ts - Preserve/diverge culture\n- colonyFounding.ts - Cultural expansion\n- anomalyManifestation.ts - Culture-specific attraction\n- techInnovation.ts - Aurora-stack favored\n- crisisLegislation.ts, greatFestival.ts, ideologyEmergence.ts - Cultural context","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T14:59:23.925130061-07:00","updated_at":"2025-11-28T15:15:10.997718789-07:00","closed_at":"2025-11-28T15:15:10.997718789-07:00"}
{"id":"penguin-tales-4c4.2","title":"Update penguin schema with snapshot configs","description":"In penguin-tales/lore/schema.ts, add snapshotConfig to each entity kind:\n\n- npc: track leader_of links\n- location: count resident_of, track controls/stronghold_of  \n- faction: track leader_of, stronghold_of, allied_with, at_war_with\n- rules: track weaponized_by, kept_secret_by\n- abilities: count practitioner_of, track manifests_at","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T09:45:19.18671283-07:00","updated_at":"2025-11-26T09:59:17.839331107-07:00","closed_at":"2025-11-26T09:59:17.839335185-07:00"}
{"id":"penguin-tales-94c","title":"Add unit tests to world-gen-naming","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T08:40:53.557142796-07:00","updated_at":"2025-11-28T05:10:59.837531811-07:00","closed_at":"2025-11-28T05:10:59.837531811-07:00"}
{"id":"penguin-tales-5ue","title":"Complete Graph API encapsulation migration in actionDomains.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-27T13:01:33.950052505-07:00","updated_at":"2025-11-27T13:10:22.738854348-07:00","closed_at":"2025-11-27T13:10:22.738854348-07:00"}
{"id":"penguin-tales-8vi","title":"Lint project with eslint complexity rules","description":"## Lint Results Summary\n\n**Total issues: 216** (excluding tests)\n\n### By Type:\n- `no-explicit-any`: 66 (type safety)\n- `no-unused-vars`: 49 (dead code)\n- `complexity`: 44 (cyclomatic complexity \u003e 15)\n- `max-lines`: 18 (file/function too long)\n- `cognitive-complexity`: 18 (Sonar metric \u003e 15)\n- `max-params`: 14 (\u003e 4 params)\n\n### Worst Files:\n1. **worldEngine.ts** - 26 errors, 4 warnings (2400+ lines, God object)\n2. **metaEntityFormation.ts** - 20 errors\n3. **enrichmentService.ts** - 12 errors\n4. **contractEnforcer.ts** - 10 errors\n5. **helpers.ts** - 9 errors, 4 warnings\n\n### Key Actions:\n- worldEngine.ts needs major decomposition\n- Many `any` types need proper typing\n- Dead code cleanup (49 unused vars)\n- Complex methods need extraction (checkContractEnabledBy, validateCoverage, runGrowthPhase)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T03:55:34.369968847-07:00","updated_at":"2025-11-28T04:01:42.791868241-07:00","closed_at":"2025-11-28T04:01:42.791868241-07:00"}
{"id":"penguin-tales-jbj","title":"Setup world-gen-naming package structure and dependencies","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T07:48:39.788533653-07:00","updated_at":"2025-11-24T07:57:28.418387576-07:00","closed_at":"2025-11-24T07:57:28.418387576-07:00","dependencies":[{"issue_id":"penguin-tales-jbj","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T07:48:39.794868156-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-xx6.2","title":"Create entityArchival.ts with archival utilities","description":"Create apps/lore-weave/lib/utils/entityArchival.ts:\n\n- archiveEntity(graph, entityId): Mark entity as historical\n- archiveRelationship(graph, src, dst, kind): Mark relationship as historical  \n- transferRelationships(graph, fromIds, toId): Move relationships to new entity\n- preservePartOfLinks(graph, childIds, parentId): Create part_of relationships","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T09:45:05.995788761-07:00","updated_at":"2025-11-26T09:50:41.908891632-07:00","closed_at":"2025-11-26T09:50:41.908896111-07:00"}
{"id":"penguin-tales-pnj.5","title":"Update domain pressures to measure cultural state","description":"Update penguin domain pressures to measure actual cultural alignment/divergence.\n\n**File: penguin-tales/lore/config/pressures.ts**\n\n**Update cultural_tension pressure:**\nCurrent implementation measures faction fragmentation and colony isolation (political metrics).\nShould measure actual cultural state:\n\n```typescript\ncultural_tension: {\n  sources: ['cross_culture_relationships', 'cultural_mixing', 'faction_splinter'],\n  sinks: ['assimilation', 'cultural_homogeneity', 'time'],\n  growth: (graph) =\u003e {\n    // 1. Cross-culture relationship ratio\n    const allRelationships = graph.getRelationships();\n    const crossCultureRels = allRelationships.filter(r =\u003e {\n      const src = graph.getEntity(r.src);\n      const dst = graph.getEntity(r.dst);\n      return src \u0026\u0026 dst \u0026\u0026 src.culture !== dst.culture;\n    });\n    const crossCultureRatio = crossCultureRels.length / Math.max(1, allRelationships.length);\n    \n    // 2. Location cultural diversity\n    const locations = graph.getEntitiesByKind('location');\n    let totalDiversity = 0;\n    for (const loc of locations) {\n      const residents = graph.findRelationships({ kind: 'resident_of', dst: loc.id });\n      const cultures = new Set(residents.map(r =\u003e graph.getEntity(r.src)?.culture));\n      totalDiversity += cultures.size \u003e 1 ? (cultures.size - 1) * 0.5 : 0;\n    }\n    \n    // 3. Faction cultural diversity  \n    const factions = graph.getEntitiesByKind('faction');\n    let factionDiversity = 0;\n    for (const faction of factions) {\n      const members = graph.findRelationships({ kind: 'member_of', dst: faction.id });\n      const cultures = new Set(members.map(r =\u003e graph.getEntity(r.src)?.culture));\n      factionDiversity += cultures.size \u003e 1 ? (cultures.size - 1) * 0.3 : 0;\n    }\n    \n    return crossCultureRatio * 10 + totalDiversity + factionDiversity;\n  },\n  decay: (graph) =\u003e {\n    // Decay when cultures are homogeneous\n    const locations = graph.getEntitiesByKind('location');\n    let homogeneousCount = 0;\n    for (const loc of locations) {\n      const residents = graph.findRelationships({ kind: 'resident_of', dst: loc.id });\n      const cultures = new Set(residents.map(r =\u003e graph.getEntity(r.src)?.culture));\n      if (cultures.size \u003c= 1) homogeneousCount++;\n    }\n    return homogeneousCount * 0.5;\n  }\n}\n```\n\n**Add new pressure: cultural_harmony**\n```typescript\ncultural_harmony: {\n  description: 'Measures cultural unity and cooperation within cultures',\n  sources: ['same_culture_alliances', 'cultural_homogeneity', 'assimilation'],\n  sinks: ['cross_culture_conflict', 'cultural_divergence'],\n  growth: (graph) =\u003e {\n    // Reward same-culture faction alliances\n    const alliances = graph.findRelationships({ kind: 'allied_with' });\n    const sameCultureAlliances = alliances.filter(r =\u003e {\n      const src = graph.getEntity(r.src);\n      const dst = graph.getEntity(r.dst);\n      return src \u0026\u0026 dst \u0026\u0026 src.culture === dst.culture;\n    });\n    return sameCultureAlliances.length * 2;\n  }\n}\n```\n\n**Update era modifiers to reference cultural pressures:**\n- Expansion era: cultural_harmony grows faster (unified expansion)\n- Conflict era: cultural_tension grows faster (cultural friction)\n- Reconstruction era: assimilation increases (cultures merge after conflict)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T14:59:55.211399856-07:00","updated_at":"2025-11-28T15:15:11.022106663-07:00","closed_at":"2025-11-28T15:15:11.022106663-07:00"}
{"id":"penguin-tales-4c4","title":"Remove hardcoded entity kind logic from framework","description":"The framework has hardcoded knowledge of entity kinds (npc, location, faction, etc.) in:\n- worldEngine.ts: createEntitySnapshot(), detectChanges()\n- changeDetection.ts: entity-kind-specific snapshot logic\n\n**Solution:**\n1. Extend EntityKindDefinition with snapshotConfig\n2. Domain defines how each entity kind should be tracked\n3. Framework uses domain schema to determine change detection rules\n\n**Tasks:**\n- Add snapshotConfig to EntityKindDefinition interface\n- Create generic snapshot creation based on domain config\n- Update penguin schema with snapshot configs for each entity kind\n- Remove entity-kind-specific if/else chains from framework","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-26T09:44:40.523161736-07:00","updated_at":"2025-11-28T14:28:22.589599457-07:00","closed_at":"2025-11-28T14:28:22.589599457-07:00"}
{"id":"penguin-tales-9d9","title":"Attraction/Repulsion placement","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-26T20:44:01.435554465-07:00","updated_at":"2025-11-26T20:51:33.442953884-07:00","closed_at":"2025-11-26T20:51:33.442953884-07:00"}
{"id":"penguin-tales-5u1","title":"Phase 1: Implement core name generation framework","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-24T07:48:25.713081408-07:00","updated_at":"2025-11-24T08:09:44.911704429-07:00","closed_at":"2025-11-24T08:09:44.911704429-07:00"}
{"id":"penguin-tales-j2f","title":"Implement capacity metrics (collision rate, entropy)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T08:27:00.38943183-07:00","updated_at":"2025-11-24T08:30:06.54090564-07:00","closed_at":"2025-11-24T08:30:06.54090564-07:00","dependencies":[{"issue_id":"penguin-tales-j2f","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T08:27:00.390078361-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-f3d","title":"Implement feature extraction for names","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T08:27:00.835307864-07:00","updated_at":"2025-11-24T08:31:30.826034897-07:00","closed_at":"2025-11-24T08:31:30.826034897-07:00","dependencies":[{"issue_id":"penguin-tales-f3d","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T08:27:00.836051266-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-kr7.1","title":"Create frameworkPrimitives.ts with constants and type guards","description":"Create apps/lore-weave/lib/types/frameworkPrimitives.ts containing:\n\n- FRAMEWORK_ENTITY_KINDS = { ERA: 'era' }\n- FRAMEWORK_RELATIONSHIP_KINDS = { PART_OF: 'part_of', SUPERSEDES: 'supersedes', ACTIVE_DURING: 'active_during' }\n- FRAMEWORK_STATUS = { HISTORICAL: 'historical', ACTIVE: 'active' }\n- Type guards: isFrameworkRelationship(), isFrameworkStatus()\n- Export from index.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T09:44:49.809723707-07:00","updated_at":"2025-11-26T09:48:41.399444717-07:00","closed_at":"2025-11-26T09:48:41.399448603-07:00"}
{"id":"penguin-tales-4c4.1","title":"Add snapshotConfig to EntityKindDefinition","description":"Extend EntityKindDefinition in domainSchema.ts:\n\nsnapshotConfig?: {\n  countRelationships?: Array\u003c{\n    field: string;\n    relationshipKind: string;\n    direction: 'src' | 'dst';\n  }\u003e;\n  trackRelationships?: Array\u003c{\n    field: string;\n    relationshipKinds: string[];\n    direction: 'src' | 'dst';\n    single?: boolean;\n  }\u003e;\n  trackLinks?: Array\u003c{\n    field: string;\n    linkKind: string;\n  }\u003e;\n}","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T09:45:19.071079758-07:00","updated_at":"2025-11-26T09:58:29.472471892-07:00","closed_at":"2025-11-26T09:58:29.472475619-07:00"}
{"id":"penguin-tales-kdm","title":"Halton Sequence placement","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T20:44:00.634504309-07:00","updated_at":"2025-11-26T20:51:28.639967852-07:00","closed_at":"2025-11-26T20:51:28.639967852-07:00"}
{"id":"penguin-tales-3qp","title":"UI: Remove penguin domain knowledge","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-27T11:35:01.192864454-07:00","updated_at":"2025-11-27T11:49:54.803334796-07:00","closed_at":"2025-11-27T11:49:54.803334796-07:00"}
{"id":"penguin-tales-llw","title":"Implment world-gen-naming/01_FRAMEWORK.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T07:37:18.614495044-07:00","updated_at":"2025-11-28T10:00:06.05315682-07:00","closed_at":"2025-11-28T10:00:06.05315682-07:00"}
{"id":"penguin-tales-zd6","title":"UI: Coordinate-aware visualization","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-27T11:34:56.037708223-07:00","updated_at":"2025-11-27T12:32:23.448630517-07:00","closed_at":"2025-11-27T12:32:23.448630517-07:00"}
{"id":"penguin-tales-60a","title":"Implement diffuseness metrics (nearest-neighbor analysis)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T08:27:00.610513663-07:00","updated_at":"2025-11-24T08:30:46.069692915-07:00","closed_at":"2025-11-24T08:30:46.069692915-07:00","dependencies":[{"issue_id":"penguin-tales-60a","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T08:27:00.611402782-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-d97","title":"Build validation CLI and reporters","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T08:27:01.220321146-07:00","updated_at":"2025-11-24T08:35:08.709297836-07:00","closed_at":"2025-11-24T08:35:08.709297836-07:00","dependencies":[{"issue_id":"penguin-tales-d97","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T08:27:01.221548948-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-vm4","title":"Placement Scheme Algorithms","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T20:39:26.778905748-07:00","updated_at":"2025-11-26T20:44:13.601411258-07:00","closed_at":"2025-11-26T20:44:13.601411258-07:00"}
{"id":"penguin-tales-dup","title":"Complete tags array to KVP migration in domain templates and systems","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-27T13:01:33.840117739-07:00","updated_at":"2025-11-27T13:10:22.641201746-07:00","closed_at":"2025-11-27T13:10:22.641201746-07:00"}
{"id":"penguin-tales-40w","title":"Implement style transforms (apostrophes, hyphens, capitalization)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T07:48:40.383138866-07:00","updated_at":"2025-11-24T08:01:42.444647051-07:00","closed_at":"2025-11-24T08:01:42.444647051-07:00","dependencies":[{"issue_id":"penguin-tales-40w","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T07:48:40.38398474-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-xx6.4","title":"Convert legal code formation to SimulationSystem","description":"In penguin-tales/lore/systems/:\n\nCreate legalCodeFormation.ts as a SimulationSystem that:\n- Uses clusterEntities() from framework\n- Defines penguin-specific similarity function\n- Creates legal code entity\n- Creates governance faction (domain-specific side effect)\n- Uses framework archival utilities\n\nRemove from metaEntityConfigs.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T09:45:06.262746603-07:00","updated_at":"2025-11-26T09:54:40.19833342-07:00","closed_at":"2025-11-26T09:54:40.198337821-07:00"}
{"id":"penguin-tales-rne","title":"Implement morphology application (prefixes, suffixes, structures)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T07:48:40.226495127-07:00","updated_at":"2025-11-24T08:01:01.031244943-07:00","closed_at":"2025-11-24T08:01:01.031244943-07:00","dependencies":[{"issue_id":"penguin-tales-rne","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T07:48:40.227233893-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-2la","title":"Phase 2: Implement validation metrics system","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-24T08:26:59.87806488-07:00","updated_at":"2025-11-24T08:35:09.273006645-07:00","closed_at":"2025-11-24T08:35:09.273006645-07:00"}
{"id":"penguin-tales-6fb","title":"Move entityRegistries.ts to domain layer","description":"entityRegistries.ts defines all entity kinds, subtypes, and template references. Should be domain-specific.","notes":"File doesn't exist - entityRegistries.ts not found in codebase. Either removed, renamed, or was never created. Task obsolete.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T10:09:32.763884478-07:00","updated_at":"2025-11-28T04:29:35.136488404-07:00","closed_at":"2025-11-28T04:29:35.13649366-07:00"}
{"id":"penguin-tales-kzq","title":"Validate name-forge integration - entities not showing penguin names","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T05:52:41.899003119-07:00","updated_at":"2025-11-28T09:59:04.466239266-07:00","closed_at":"2025-11-28T09:59:04.466239266-07:00"}
{"id":"penguin-tales-rgj","title":"Extract occurrence relationship kinds to domain schema","description":"occurrenceCreation.ts references domain relationship kinds (participant_in, epicenter_of, triggered_by). Move to domain config.","notes":"Analysis: occurrenceCreation.ts hardcodes 'participant_in', 'epicenter_of', 'triggered_by' relationship kinds in contract and code. Options: 1) Add to FRAMEWORK_RELATIONSHIP_KINDS if universal to all domains, 2) Move to domain config and read via graph.config.domain, 3) Move entire occurrenceCreation system to domain layer. Part of larger a3l epic for framework/domain separation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T10:09:32.802241491-07:00","updated_at":"2025-11-28T04:27:39.069150323-07:00","closed_at":"2025-11-28T04:27:39.069156034-07:00"}
{"id":"penguin-tales-3qn","title":"Research library replacements for reimplemented algorithms","description":"## Library Replacement Research\n\n### HIGH PRIORITY REPLACEMENTS\n\n**1. turf.js** - Would replace ~10 geometry functions:\n- Point-in-polygon (ray casting) in regionMapper.ts\n- Euclidean distance calculations\n- Polygon area (shoelace formula)\n- Polygon centroid\n- Bounding box calculations\n\n**2. simple-statistics** - Statistical functions:\n- Shannon entropy (distributionCalculations.ts)\n- Variance/StdDev (statisticsCollector.ts)\n- Mean absolute deviation\n\n**3. graphlib** - Graph algorithms:\n- DFS for connected components (statisticsCollector.ts)\n- Graph traversal utilities\n\n**4. poisson-disk-sampling** - Spatial distribution:\n- regionPlacement.ts rejection sampling\n\n### BUGS FOUND\n⚠️ **Fisher-Yates shuffle in helpers.ts uses `sort(() =\u003e Math.random() - 0.5)`** - This is NOT a proper shuffle and produces biased results. Replace with lodash.shuffle or fast-shuffle.\n\n### NOT WORTH REPLACING (Domain-Specific)\n- Weighted scoring/hub penalties in targetSelector.ts\n- Homeostatic control in dynamicWeightCalculator.ts\n- Greedy clustering in clusteringUtils.ts (tuned for world gen)\n\n### SUMMARY\n| Library | Functions Replaced | Files Affected |\n|---------|-------------------|----------------|\n| turf.js | 10+ | regionMapper.ts, regionPlacement.ts |\n| simple-statistics | 5 | distributionCalculations.ts, statisticsCollector.ts |\n| graphlib | 2 | statisticsCollector.ts, graphQueries.ts |\n| poisson-disk-sampling | 1 | regionPlacement.ts |\n| lodash/fast-shuffle | 1 | helpers.ts (BUG FIX)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T03:55:41.458497754-07:00","updated_at":"2025-11-28T04:03:13.871724002-07:00","closed_at":"2025-11-28T04:03:13.871724002-07:00"}
{"id":"penguin-tales-pnj.2","title":"Add CulturalAwarenessAnalyzer to framework","description":"Create a framework-level debug/reporting mechanism that detects when domain code is not being culturally aware.\n\n**New file: apps/lore-weave/lib/services/culturalAwarenessAnalyzer.ts**\n\n**Tracks and reports:**\n1. **Cross-culture relationships formed** - Log when relationships form between entities of different cultures\n2. **Culture-blind entity creation** - Detect when templates create entities without considering parent culture\n3. **Selection operations without culture bias** - Track selectTargets() calls that don't use culture parameters\n4. **Cultural homogeneity metrics** - Per-location and per-faction cultural diversity scores\n\n**Interface:**\n```typescript\ninterface CulturalAwarenessReport {\n  // Relationship analysis\n  crossCultureRelationships: number;\n  sameCultureRelationships: number;\n  crossCultureRatio: number;\n  \n  // Entity creation analysis\n  entitiesMatchingParentCulture: number;\n  entitiesMismatchingParentCulture: number;\n  orphanedCultureEntities: number;  // No clear cultural parent\n  \n  // Selection analysis\n  selectionsWithCultureBias: number;\n  selectionsWithoutCultureBias: number;\n  \n  // Homogeneity metrics\n  locationCulturalDiversity: Map\u003cstring, number\u003e;  // location -\u003e diversity score\n  factionCulturalDiversity: Map\u003cstring, number\u003e;   // faction -\u003e diversity score\n  \n  // Warnings\n  warnings: string[];\n}\n```\n\n**Integration points:**\n1. Hook into TemplateGraphView.createEntity() to track culture decisions\n2. Hook into relationship creation to track cross-culture links\n3. Hook into selectTargets() to track culture bias usage\n4. Call analyzer.report() at end of each epoch for summary\n\n**Output:** Add to existing statistics output or create cultural_awareness.log","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T14:59:10.62249352-07:00","updated_at":"2025-11-28T15:14:46.960787405-07:00","closed_at":"2025-11-28T15:14:46.960787405-07:00"}
{"id":"penguin-tales-4ye","title":"PlacementScheme type system","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T20:43:54.417127809-07:00","updated_at":"2025-11-26T20:45:48.035517671-07:00","closed_at":"2025-11-26T20:45:48.035517671-07:00"}
{"id":"penguin-tales-apl","title":"Remove createGovernanceFaction from framework metaEntityFormation.ts","description":"Analysis from ti1: Framework metaEntityFormation.ts has createGovernanceFaction() creating domain-specific 'faction:political' entities. Domain already has legalCodeFormation.ts with same functionality. Remove framework version, rely on domain implementation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T04:31:39.854384645-07:00","updated_at":"2025-11-28T04:46:26.316600297-07:00","closed_at":"2025-11-28T04:46:26.316600297-07:00"}
{"id":"penguin-tales-dwr","title":"Parameterize 'anomaly' subtype in emergentDiscovery.ts","description":"Analysis from 7si: emergentDiscovery.ts hardcodes 'anomaly' subtype (lines 192, 309). Add 'anomalySubtype' config field and read via requireConfigValue() like other config values.","notes":"emergentDiscovery.ts contains domain-specific concepts (magic, anomalies, resource types). Moving entire file to penguin-tales domain.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T04:31:40.075791123-07:00","updated_at":"2025-11-28T04:38:11.78927027-07:00","closed_at":"2025-11-28T04:38:11.78927027-07:00"}
{"id":"penguin-tales-a3l","title":"Framework/Domain Separation: Remove penguin-specific hardcoding from lore-weave framework","description":"Extract domain-specific elements from framework code","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-26T10:09:23.560430058-07:00","updated_at":"2025-11-28T14:32:10.990850191-07:00","closed_at":"2025-11-28T14:32:10.990850191-07:00"}
{"id":"penguin-tales-3vs","title":"Move feedbackLoops config to domain","description":"feedbackLoops in lib/config/ contains domain-specific data. Should be passed via EngineConfig from domain.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T05:19:53.587956838-07:00","updated_at":"2025-11-28T05:25:52.430635599-07:00","closed_at":"2025-11-28T05:25:52.430635599-07:00"}
{"id":"penguin-tales-89w","title":"Implement string distance metrics (Levenshtein, shape-based)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T08:27:00.205136404-07:00","updated_at":"2025-11-24T08:29:26.825365339-07:00","closed_at":"2025-11-24T08:29:26.825365339-07:00","dependencies":[{"issue_id":"penguin-tales-89w","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T08:27:00.20584769-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-2mz","title":"Implement mock KG (HardState and Relationship types)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T07:48:40.753282658-07:00","updated_at":"2025-11-28T03:56:35.103288872-07:00","closed_at":"2025-11-28T03:56:35.103288872-07:00","dependencies":[{"issue_id":"penguin-tales-2mz","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T07:48:40.753910087-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-cbn","title":"Integrate name-forge into lore-weave framework","notes":"Phase 1: Framework Changes - Create nameForgeService.ts, update addEntity(), remove old name generation. Phase 2: Domain Changes - Create config JSON, update main.ts and templates.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T12:29:59.975305053-07:00","updated_at":"2025-11-26T12:40:25.911829326-07:00","closed_at":"2025-11-26T12:40:25.911829326-07:00"}
{"id":"penguin-tales-xx6","title":"Refactor meta-entity formation to SimulationSystem pattern","description":"Convert MetaEntityFormation service to a configurable SimulationSystem pattern:\n\n**Current Problems:**\n- MetaEntityConfig has domain logic (createGovernanceFaction)\n- Hardcoded clustering criteria types\n- Special service instead of reusing existing system abstraction\n\n**Solution:**\n1. Create framework clustering utilities (clusterEntities, transferRelationships, archiveEntity)\n2. Remove MetaEntityFormation service\n3. Domain defines meta-entity systems using SimulationSystem interface\n4. Move createGovernanceFaction to domain as post-formation hook or separate system\n\n**Tasks:**\n- Create apps/lore-weave/lib/utils/clusteringUtils.ts\n- Create apps/lore-weave/lib/utils/entityArchival.ts\n- Update penguin domain to use system pattern for magic schools, legal codes\n- Remove MetaEntityFormation service and MetaEntityConfig type","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-26T09:44:32.633169183-07:00","updated_at":"2025-11-28T14:28:22.679468259-07:00","closed_at":"2025-11-28T14:28:22.679468259-07:00"}
{"id":"penguin-tales-ulk","title":"Implement domain selector (kind/subKind/tags matching)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T07:48:40.570036991-07:00","updated_at":"2025-11-24T08:02:23.295546551-07:00","closed_at":"2025-11-24T08:02:23.295546551-07:00","dependencies":[{"issue_id":"penguin-tales-ulk","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T07:48:40.570818564-07:00","created_by":"daemon"}]}
{"id":"penguin-tales-x2d","title":"Extract action domain logic from catalystHelpers.ts","description":"catalystHelpers.ts contains subtype-to-action-domain mappings and occurrence types. Move to domain config.","notes":"Already done! Action domain logic properly delegated to domain: 1) Framework defines interface in domainSchema.ts (getActionDomains, getActionDomainsForEntity), 2) Domain implements in penguin-tales/lore/config/actionDomains.ts, 3) Framework reads via graph.config.domain.getActionDomainsForEntity(). No changes needed.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T10:09:32.773665671-07:00","updated_at":"2025-11-28T04:29:18.835993362-07:00","closed_at":"2025-11-28T04:29:18.835998014-07:00"}
{"id":"penguin-tales-pnj.1","title":"Add culture-aware selection to TargetSelector","description":"Extend SelectionBias interface to support culture preferences.\n\n**Changes to apps/lore-weave/lib/selection/targetSelector.ts:**\n\n```typescript\ninterface SelectionBias {\n  // Existing fields...\n  \n  // NEW: Culture-aware selection\n  sameCultureAs?: string;           // Prefer entities matching this culture\n  differentCulturePenalty?: number; // Multiplier for cross-culture (default 1.0, use 0.5 to halve chance)\n  requireCulture?: string;          // Hard filter - only entities with this culture\n  excludeCultures?: string[];       // Hard filter - exclude these cultures\n}\n```\n\n**Implementation:**\n1. In scoring logic, apply sameCultureAs boost (e.g., 2.0x for match)\n2. Apply differentCulturePenalty for non-matches\n3. Apply hard filters in initial candidate filtering\n\n**Usage in templates:**\n```typescript\nconst cultists = graphView.selectTargets('npc', count, {\n  sameCultureAs: location.culture,\n  differentCulturePenalty: 0.3  // Cross-culture recruitment is rare\n});\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T14:58:58.885448562-07:00","updated_at":"2025-11-28T15:04:11.47485603-07:00","closed_at":"2025-11-28T15:04:11.47485603-07:00"}
{"id":"penguin-tales-xx6.3","title":"Convert magic school formation to SimulationSystem","description":"In penguin-tales/lore/systems/:\n\nCreate magicSchoolFormation.ts as a SimulationSystem that:\n- Uses clusterEntities() from framework\n- Defines penguin-specific similarity function\n- Creates meta-entity using domain factory\n- Uses framework archival utilities\n\nRemove from metaEntityConfigs.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T09:45:06.122530234-07:00","updated_at":"2025-11-26T09:52:11.93500317-07:00","closed_at":"2025-11-26T09:52:11.935007638-07:00"}
{"id":"penguin-tales-m5z","title":"Rationalize test suite","notes":"Progress: Fixed null check in templateGraphView.ts constructor.\nTests improved from 363 failing to 291 failing (945 passing).\n\nRemaining issues:\n- Test mocks use old Graph interface (direct property access vs getEntity/getRelationships methods)\n- Need proper mock factory that matches current Graph API\n- 18 test files still failing\n\nSuggested fix: Create createMockGraph() helper that returns Graph with proper methods","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-27T11:35:08.395259267-07:00","updated_at":"2025-11-28T09:54:34.804178959-07:00","closed_at":"2025-11-28T09:54:34.804178959-07:00"}
{"id":"penguin-tales-dgt","title":"Implement separation metrics with classifier","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T08:27:01.028419072-07:00","updated_at":"2025-11-24T08:32:52.398269076-07:00","closed_at":"2025-11-24T08:32:52.398269076-07:00","dependencies":[{"issue_id":"penguin-tales-dgt","depends_on_id":"penguin-tales-5u1","type":"discovered-from","created_at":"2025-11-24T08:27:01.029028302-07:00","created_by":"daemon"}]}
