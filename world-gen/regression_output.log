
> penguin-history-engine@1.0.0 start
> node dist/main.js

ðŸ“ Scale Factor: 1x
ðŸ“‚ Using default config
===========================================
   PROCEDURAL WORLD HISTORY GENERATOR
      Super Penguin Colony Simulation
===========================================

LLM enrichment: disabled
Image generation: disabled

================================================================================
FRAMEWORK VALIDATION
================================================================================
âœ“ No validation errors

âš ï¸  VALIDATION WARNINGS:
  - Pressure 'Resource Scarcity' equilibrium mismatch: predicted=0.0, expected=[25, 40]. Consider adjusting sources, sinks, or decay rate.
  - Pressure 'Conflict Tension' equilibrium mismatch: predicted=0.0, expected=[30, 50]. Consider adjusting sources, sinks, or decay rate.
  - Pressure 'Magical Instability' equilibrium mismatch: predicted=0.0, expected=[20, 45]. Consider adjusting sources, sinks, or decay rate.
  - Pressure 'Cultural Divergence' equilibrium mismatch: predicted=0.0, expected=[30, 50]. Consider adjusting sources, sinks, or decay rate.
  - Pressure 'Political Stability' equilibrium mismatch: predicted=0.0, expected=[40, 60]. Consider adjusting sources, sinks, or decay rate.
  - Pressure 'External Danger' equilibrium mismatch: predicted=0.0, expected=[10, 25]. Consider adjusting sources, sinks, or decay rate.
================================================================================

âœ“ Statistical template selection enabled
âœ“ Statistical system weighting enabled
âœ“ Homeostatic feedback control enabled
  - Tracking 30 feedback loops
âœ“ Contract enforcement enabled
  - Template filtering by enabledBy conditions
  - Automatic lineage relationship creation
  - Entity saturation control
  - Contract affects validation
âœ“ Intelligent target selection enabled (anti-super-hub)
âœ“ Meta-entity formation system initialized
  - Registered magic school formation
  - Registered legal code formation
  - Registered combat technique formation
Starting world generation...
Initial state: 14 entities

=== Epoch 0: The Great Thaw ===
  âš ï¸  Template cult_formation contract violations:
      Created 2 entities, but contract allows max 1
  âš ï¸  Template cult_formation contract violations:
      Created 2 entities, but contract allows max 1
  Growth: +15 entities (target: 15)
  Entities by kind: {
  location: 11,
  faction: 4,
  npc: 6,
  abilities: 4,
  rules: 4,
  era: 5,
  occurrence: 2
}
  Relationships: 136
  Pressures: {
  resource_scarcity: 11.408,
  conflict: 16.779666666666667,
  magical_instability: 31.9625,
  cultural_tension: 0,
  stability: 54.800000000000004,
  external_threat: 0
}

  === Distribution Statistics ===
  Entity Kinds (current vs target):
    âœ“ location: 30.6% (target: 30.0%, +0.6%)
    âš ï¸ faction: 11.1% (target: 20.0%, -8.9%)
    âœ“ npc: 16.7% (target: 20.0%, -3.3%)
    âœ“ abilities: 11.1% (target: 15.0%, -3.9%)
    âœ“ rules: 11.1% (target: 15.0%, -3.9%)
    âš ï¸ era: 13.9% (target: 0.0%, +13.9%)
    âš ï¸ occurrence: 5.6% (target: 0.0%, +5.6%)
  Prominence (current vs target):
    âš ï¸ forgotten: 0.0% (target: 10.0%, -10.0%)
    âœ“ marginal: 25.0% (target: 25.0%, 0.0%)
    âš ï¸ recognized: 41.7% (target: 30.0%, +11.7%)
    âš ï¸ renowned: 11.1% (target: 25.0%, -13.9%)
    âš ï¸ mythic: 22.2% (target: 10.0%, +12.2%)
  Top relationship types:
    âœ“ trades_with: 11.8%
    âœ“ adjacent_to: 10.3%
    âœ“ practitioner_of: 8.1%
    âœ“ resident_of: 5.9%
    âœ“ allied_with: 5.9%
  Graph Connectivity:
    Clusters: 14 (target: 5)
    Avg cluster size: 2.6
    Avg connections/entity: 7.6
    Isolated nodes: 13 (36.1%)

  Overall Deviation Score: 0.236
  âš ï¸  HIGH DEVIATION - template selection will be heavily guided

=== Epoch 1: The Great Thaw ===
  âš ï¸  Template cult_formation contract violations:
      Created 2 entities, but contract allows max 1
  âš ï¸  Template anomaly_manifestation contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template cult_formation contract violations:
      Created 2 entities, but contract allows max 1
  âš ï¸  Template anomaly_manifestation contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template cult_formation contract violations:
      Created 2 entities, but contract allows max 1
âš ï¸  Auto-adding distance to adjacent_to relationship (location_1034 â†’ Nightfall Shelf): 0.055
  âš ï¸  Template anomaly_manifestation contract violations:
      Created 4 relationships, but contract suggests max ~3
  Growth: +16 entities (target: 16)
  Entities by kind: {
  location: 15,
  faction: 7,
  npc: 9,
  abilities: 9,
  rules: 5,
  era: 5,
  occurrence: 2
}
  Relationships: 235
  Pressures: {
  resource_scarcity: 11.408,
  conflict: 19.586557983401452,
  magical_instability: 34.14281871875,
  cultural_tension: 0,
  stability: 58.88166004210527,
  external_threat: 0
}

  === Distribution Statistics ===
  Entity Kinds (current vs target):
    âœ“ location: 28.8% (target: 30.0%, -1.2%)
    âš ï¸ faction: 13.5% (target: 20.0%, -6.5%)
    âœ“ npc: 17.3% (target: 20.0%, -2.7%)
    âœ“ abilities: 17.3% (target: 15.0%, +2.3%)
    âš ï¸ rules: 9.6% (target: 15.0%, -5.4%)
    âš ï¸ era: 9.6% (target: 0.0%, +9.6%)
    âœ“ occurrence: 3.8% (target: 0.0%, +3.8%)
  Prominence (current vs target):
    âš ï¸ forgotten: 1.9% (target: 10.0%, -8.1%)
    âš ï¸ marginal: 32.7% (target: 25.0%, +7.7%)
    âš ï¸ recognized: 38.5% (target: 30.0%, +8.5%)
    âš ï¸ renowned: 9.6% (target: 25.0%, -15.4%)
    âš ï¸ mythic: 17.3% (target: 10.0%, +7.3%)
  Top relationship types:
    âœ“ practitioner_of: 11.1%
    âœ“ trades_with: 11.1%
    âœ“ adjacent_to: 9.4%
    âœ“ controls: 8.9%
    âœ“ resident_of: 6.0%
  Graph Connectivity:
    Clusters: 16 (target: 5)
    Avg cluster size: 3.3
    Avg connections/entity: 9.0
    Isolated nodes: 14 (26.9%)

  Overall Deviation Score: 0.256
  âš ï¸  HIGH DEVIATION - template selection will be heavily guided

=== Epoch 2: The Great Thaw ===
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
âš ï¸  Auto-adding distance to adjacent_to relationship (The Glow-Fissure â†’ location_1042): 0.153
  âš ï¸  Template anomaly_manifestation contract violations:
      Created 4 relationships, but contract suggests max ~3
  [Attempt 50] Template trade_route_establishment found no targets
  âš ï¸  Template cult_formation contract violations:
      Created 2 entities, but contract allows max 1
  âš ï¸  Template anomaly_manifestation contract violations:
      Created 4 relationships, but contract suggests max ~3
  Growth: +15 entities (target: 15)
  Entities by kind: {
  location: 22,
  faction: 8,
  npc: 10,
  abilities: 12,
  rules: 8,
  era: 5,
  occurrence: 3
}
  Relationships: 347
  Pressures: {
  resource_scarcity: 10.831999999999999,
  conflict: 21.817759351801108,
  magical_instability: 36.75622995044011,
  cultural_tension: 0,
  stability: 62.54526915500493,
  external_threat: 0
}

  === Distribution Statistics ===
  Entity Kinds (current vs target):
    âœ“ location: 32.4% (target: 30.0%, +2.4%)
    âš ï¸ faction: 11.8% (target: 20.0%, -8.2%)
    âš ï¸ npc: 14.7% (target: 20.0%, -5.3%)
    âœ“ abilities: 17.6% (target: 15.0%, +2.6%)
    âœ“ rules: 11.8% (target: 15.0%, -3.2%)
    âš ï¸ era: 7.4% (target: 0.0%, +7.4%)
    âœ“ occurrence: 4.4% (target: 0.0%, +4.4%)
  Prominence (current vs target):
    âš ï¸ forgotten: 2.9% (target: 10.0%, -7.1%)
    âœ“ marginal: 20.6% (target: 25.0%, -4.4%)
    âš ï¸ recognized: 51.5% (target: 30.0%, +21.5%)
    âš ï¸ renowned: 10.3% (target: 25.0%, -14.7%)
    âœ“ mythic: 14.7% (target: 10.0%, +4.7%)
  Top relationship types:
    âš ï¸ controls: 15.6%
    âœ“ trades_with: 15.0%
    âœ“ practitioner_of: 9.5%
    âœ“ adjacent_to: 8.6%
    âœ“ manifests_at: 5.8%
  Graph Connectivity:
    Clusters: 19 (target: 5)
    Avg cluster size: 3.6
    Avg connections/entity: 10.2
    Isolated nodes: 18 (26.5%)

  Overall Deviation Score: 0.308
  âš ï¸  HIGH DEVIATION - template selection will be heavily guided

=== Epoch 3: The Great Thaw ===
  âš ï¸  Template cult_formation contract violations:
      Created 2 entities, but contract allows max 1
âš ï¸  Auto-adding distance to adjacent_to relationship (Windward Ridge â†’ location_1056): 0.477
  âš ï¸  Template anomaly_manifestation contract violations:
      Created 4 relationships, but contract suggests max ~3
  [Attempt 50] Template trade_route_establishment found no targets
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
  [Attempt 100] Template trade_route_establishment found no targets
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
  [Attempt 150] Template trade_route_establishment found no targets
  âš ï¸  Template cult_formation contract violations:
      Created 2 entities, but contract allows max 1
  âš ï¸  Template anomaly_manifestation would oversaturate tags: mystical
  âš ï¸  Template anomaly_manifestation contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template emergent_location_discovery would oversaturate tags: mystical
  Growth: +22 entities (target: 22)
  âœ¨ Formed: Divine Code of 4 Laws (rules, 4 entities clustered)
  âœ¨ Total meta-entities formed this epoch: 1
  Entities by kind: {
  location: 30,
  faction: 11,
  npc: 12,
  abilities: 18,
  rules: 13,
  era: 5,
  occurrence: 3
}
  Relationships: 533
  Pressures: {
  resource_scarcity: 10.831999999999999,
  conflict: 23.42193421010564,
  magical_instability: 40.17400769336651,
  cultural_tension: 0,
  stability: 65.7794726046848,
  external_threat: 0
}

  === Distribution Statistics ===
  Entity Kinds (current vs target):
    âœ“ location: 32.6% (target: 30.0%, +2.6%)
    âš ï¸ faction: 12.0% (target: 20.0%, -8.0%)
    âš ï¸ npc: 13.0% (target: 20.0%, -7.0%)
    âœ“ abilities: 19.6% (target: 15.0%, +4.6%)
    âœ“ rules: 14.1% (target: 15.0%, -0.9%)
    âš ï¸ era: 5.4% (target: 0.0%, +5.4%)
    âœ“ occurrence: 3.3% (target: 0.0%, +3.3%)
  Prominence (current vs target):
    âœ“ forgotten: 6.5% (target: 10.0%, -3.5%)
    âœ“ marginal: 23.9% (target: 25.0%, -1.1%)
    âš ï¸ recognized: 39.1% (target: 30.0%, +9.1%)
    âš ï¸ renowned: 17.4% (target: 25.0%, -7.6%)
    âœ“ mythic: 13.0% (target: 10.0%, +3.0%)
  Top relationship types:
    âš ï¸ trades_with: 22.1%
    âœ“ controls: 13.7%
    âœ“ practitioner_of: 8.1%
    âœ“ adjacent_to: 7.1%
    âœ“ manifests_at: 5.8%
  Graph Connectivity:
    Clusters: 18 (target: 5)
    Avg cluster size: 5.1
    Avg connections/entity: 11.6
    Isolated nodes: 17 (18.5%)

  Overall Deviation Score: 0.311
  âš ï¸  HIGH DEVIATION - template selection will be heavily guided

=== Epoch 4: The Faction Wars ===
  âš ï¸  Template anomaly_manifestation would oversaturate tags: mystical
  âš ï¸  Template anomaly_manifestation contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template magic_discovery would oversaturate tags: mystical
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template magic_discovery would oversaturate tags: mystical
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template emergent_location_discovery would oversaturate tags: mystical
  âš ï¸  Template emergent_location_discovery would oversaturate tags: mystical
  Growth: +20 entities (target: 20)
âš ï¸  Auto-adding distance to supersedes relationship (rules_1099 â†’ rules_1076): 0.350
âš ï¸  Auto-adding distance to part_of relationship (rules_1091 â†’ rules_1099): 0.182
  âœ¨ Formed: Holy Code of 4 Laws (rules, 4 entities clustered)
  âœ¨ Total meta-entities formed this epoch: 1
  Entities by kind: {
  location: 35,
  faction: 11,
  npc: 19,
  abilities: 22,
  rules: 18,
  era: 5,
  occurrence: 4
}
  Relationships: 599
  Pressures: {
  resource_scarcity: 85,
  conflict: 25.640491718905444,
  magical_instability: 44.31350343044372,
  cultural_tension: 0,
  stability: 71.25296278328914,
  external_threat: 0
}

  === Distribution Statistics ===
  Entity Kinds (current vs target):
    âœ“ location: 30.7% (target: 30.0%, +0.7%)
    âš ï¸ faction: 9.6% (target: 20.0%, -10.4%)
    âœ“ npc: 16.7% (target: 20.0%, -3.3%)
    âœ“ abilities: 19.3% (target: 15.0%, +4.3%)
    âœ“ rules: 15.8% (target: 15.0%, +0.8%)
    âœ“ era: 4.4% (target: 0.0%, +4.4%)
    âœ“ occurrence: 3.5% (target: 0.0%, +3.5%)
  Prominence (current vs target):
    âœ“ forgotten: 7.0% (target: 10.0%, -3.0%)
    âœ“ marginal: 27.2% (target: 25.0%, +2.2%)
    âš ï¸ recognized: 36.8% (target: 30.0%, +6.8%)
    âš ï¸ renowned: 12.3% (target: 25.0%, -12.7%)
    âš ï¸ mythic: 16.7% (target: 10.0%, +6.7%)
  Top relationship types:
    âœ“ controls: 12.9%
    âœ“ trades_with: 10.4%
    âœ“ practitioner_of: 8.8%
    âœ“ adjacent_to: 7.3%
    âœ“ manifests_at: 6.7%
  Graph Connectivity:
    Clusters: 20 (target: 5)
    Avg cluster size: 5.7
    Avg connections/entity: 10.5
    Isolated nodes: 19 (16.7%)

  Overall Deviation Score: 0.317
  âš ï¸  HIGH DEVIATION - template selection will be heavily guided

=== Epoch 5: The Faction Wars ===
  âš ï¸  Template magic_discovery would oversaturate tags: mystical
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template krill_bloom_migration contract violations:
      Created 3 entities, but contract allows max 2
  âš ï¸  Template anomaly_manifestation would oversaturate tags: mystical
  âš ï¸  Template anomaly_manifestation contract violations:
      Created 4 relationships, but contract suggests max ~3
  [Attempt 50] Template guild_establishment found no targets
  âš ï¸  Template krill_bloom_migration contract violations:
      Created 3 entities, but contract allows max 2
  âš ï¸  Template krill_bloom_migration contract violations:
      Created 3 entities, but contract allows max 2
  [Attempt 100] Template guild_establishment found no targets
  âš ï¸  Template krill_bloom_migration contract violations:
      Created 3 entities, but contract allows max 2
  Growth: +20 entities (target: 19)
  Entities by kind: {
  location: 40,
  faction: 11,
  npc: 31,
  abilities: 23,
  rules: 20,
  era: 5,
  occurrence: 4
}
  Relationships: 750
  Pressures: {
  resource_scarcity: 85,
  conflict: 27.682054447853055,
  magical_instability: 48.792157312072604,
  cultural_tension: 0,
  stability: 74.71852287020135,
  external_threat: 0
}

  === Distribution Statistics ===
  Entity Kinds (current vs target):
    âœ“ location: 29.9% (target: 30.0%, -0.1%)
    âš ï¸ faction: 8.2% (target: 20.0%, -11.8%)
    âœ“ npc: 23.1% (target: 20.0%, +3.1%)
    âœ“ abilities: 17.2% (target: 15.0%, +2.2%)
    âœ“ rules: 14.9% (target: 15.0%, -0.1%)
    âœ“ era: 3.7% (target: 0.0%, +3.7%)
    âœ“ occurrence: 3.0% (target: 0.0%, +3.0%)
  Prominence (current vs target):
    âœ“ forgotten: 6.7% (target: 10.0%, -3.3%)
    âš ï¸ marginal: 32.1% (target: 25.0%, +7.1%)
    âœ“ recognized: 34.3% (target: 30.0%, +4.3%)
    âš ï¸ renowned: 12.7% (target: 25.0%, -12.3%)
    âœ“ mythic: 14.2% (target: 10.0%, +4.2%)
  Top relationship types:
    âš ï¸ trades_with: 15.5%
    âœ“ controls: 12.1%
    âœ“ practitioner_of: 8.7%
    âœ“ adjacent_to: 7.2%
    âœ“ manifests_at: 6.3%
  Graph Connectivity:
    Clusters: 24 (target: 5)
    Avg cluster size: 5.6
    Avg connections/entity: 11.2
    Isolated nodes: 23 (17.2%)

  Overall Deviation Score: 0.370
  âš ï¸  HIGH DEVIATION - template selection will be heavily guided

âš ï¸  21 feedback loops not functioning correctly:

  Broken loops requiring attention:

  1. hero_reduces_conflict
     Wrong direction: expected negative correlation, got 0.95
     â†’ Reverse the mechanism or check if npc:hero.count actually affects conflict.value

     Detailed Analysis:
     Feedback Loop: hero_reduces_conflict
     Expected: npc:hero.count â†’ conflict.value (negative feedback)
     Problem: Wrong direction: expected negative correlation, got 0.95
     Recommendation: Reverse the mechanism or check if npc:hero.count actually affects conflict.value
     Suggested Fixes:
       1. Check if components actually implement the mechanism described
       2. Verify contract.affects declarations match actual behavior
       3. Consider inverting the feedback loop type (negative â†’ positive)

  2. conflict_triggers_heroes
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if conflict.value actually affects npc:hero.count

     Detailed Analysis:
     Feedback Loop: conflict_triggers_heroes
     Expected: conflict.value â†’ npc:hero.count (positive feedback)
     Problem: Wrong direction: expected positive correlation, got 0.00
     Recommendation: Reverse the mechanism or check if conflict.value actually affects npc:hero.count
     Suggested Fixes:
       1. Check if components actually implement the mechanism described
       2. Verify contract.affects declarations match actual behavior
       3. Consider inverting the feedback loop type (positive â†’ negative)

  3. instability_reduces_magic_creation
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if magical_instability.value actually affects abilities:magic.trend

     Detailed Analysis:
     Feedback Loop: instability_reduces_magic_creation
     Expected: magical_instability.value â†’ abilities:magic.trend (negative feedback)
     Problem: Wrong direction: expected negative correlation, got 0.00
     Recommendation: Reverse the mechanism or check if magical_instability.value actually affects abilities:magic.trend
     Suggested Fixes:
       1. Check if components actually implement the mechanism described
       2. Verify contract.affects declarations match actual behavior
       3. Consider inverting the feedback loop type (negative â†’ positive)

  4. anomaly_enables_magic
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if location:anomaly.count actually affects abilities:magic.count

  5. magic_tech_balance
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if abilities:magic.count actually affects abilities:technology.trend

  6. orca_drives_external_threat
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if npc:orca.count actually affects external_threat.value

  7. threat_triggers_orcas
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if external_threat.value actually affects npc:orca.count

  8. orca_saturation_suppresses_creation
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if npc:orca.deviation actually affects npc:orca.trend

  9. anomaly_enables_cults
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if location:anomaly.count actually affects faction:cult.count

  10. faction_fragmentation_drives_tension
     Wrong direction: expected positive correlation, got -0.32
     â†’ Reverse the mechanism or check if faction:political.count actually affects cultural_tension.value

  11. tension_triggers_splinters
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if cultural_tension.value actually affects faction:political.count

  12. alliance_reduces_tension
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if allied_with.count actually affects cultural_tension.value

  13. colony_count_drives_scarcity
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if location:colony.count actually affects resource_scarcity.value

  14. scarcity_triggers_exploration
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if resource_scarcity.value actually affects location:geographic_feature.count

  15. resources_reduce_scarcity
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if location:geographic_feature.count actually affects resource_scarcity.value

  16. alliances_reduce_conflict
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if allied_with.count actually affects conflict.value

  17. conflict_triggers_wars
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if conflict.value actually affects occurrence:war.count

  18. succession_reduces_stability
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if npc:mayor.count actually affects stability.value

  19. stability_reduces_splinters
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if stability.value actually affects faction:political.trend

  20. rules_reduce_tension
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if rules:social.count actually affects cultural_tension.value

  21. tension_triggers_ideology
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if cultural_tension.value actually affects rules:social.count

     ... and 18 more broken loops
     Use printDetailedDiagnostics() for full analysis

=== Epoch 6: The Clever Ice Age ===
  âš ï¸  Template tech_innovation contract violations:
      Created 5 relationships, but contract suggests max ~4
  âš ï¸  Template tech_innovation contract violations:
      Created 5 relationships, but contract suggests max ~4
  âš ï¸  Template krill_bloom_migration contract violations:
      Created 3 entities, but contract allows max 2
  âš ï¸  Template tech_innovation contract violations:
      Created 5 relationships, but contract suggests max ~4
  âš ï¸  Template tech_innovation contract violations:
      Created 5 relationships, but contract suggests max ~4
  Growth: +16 entities (target: 17)
  Entities by kind: {
  location: 44,
  faction: 15,
  npc: 34,
  abilities: 28,
  rules: 20,
  era: 5,
  occurrence: 4
}
  Relationships: 914
  Pressures: {
  resource_scarcity: 85,
  conflict: 29.435824780570936,
  magical_instability: 51.34757124418616,
  cultural_tension: 85,
  stability: 77.38832147392355,
  external_threat: 0
}

  === Distribution Statistics ===
  Entity Kinds (current vs target):
    âœ“ location: 29.3% (target: 30.0%, -0.7%)
    âš ï¸ faction: 10.0% (target: 20.0%, -10.0%)
    âœ“ npc: 22.7% (target: 20.0%, +2.7%)
    âœ“ abilities: 18.7% (target: 15.0%, +3.7%)
    âœ“ rules: 13.3% (target: 15.0%, -1.7%)
    âœ“ era: 3.3% (target: 0.0%, +3.3%)
    âœ“ occurrence: 2.7% (target: 0.0%, +2.7%)
  Prominence (current vs target):
    âœ“ forgotten: 6.0% (target: 10.0%, -4.0%)
    âš ï¸ marginal: 32.0% (target: 25.0%, +7.0%)
    âš ï¸ recognized: 37.3% (target: 30.0%, +7.3%)
    âš ï¸ renowned: 12.7% (target: 25.0%, -12.3%)
    âœ“ mythic: 12.0% (target: 10.0%, +2.0%)
  Top relationship types:
    âš ï¸ trades_with: 22.8%
    âœ“ controls: 10.5%
    âœ“ practitioner_of: 9.3%
    âœ“ adjacent_to: 6.1%
    âœ“ resident_of: 5.9%
  Graph Connectivity:
    Clusters: 22 (target: 5)
    Avg cluster size: 6.8
    Avg connections/entity: 12.2
    Isolated nodes: 21 (14.0%)

  Overall Deviation Score: 0.364
  âš ï¸  HIGH DEVIATION - template selection will be heavily guided

=== Epoch 7: The Clever Ice Age ===
  [Attempt 50] Template trade_route_establishment found no targets
  [Attempt 100] Template trade_route_establishment found no targets
  [Attempt 200] Template trade_route_establishment found no targets
  [Attempt 250] Template trade_route_establishment found no targets
  Growth: +13 entities (target: 25)
  Entities by kind: {
  location: 45,
  faction: 15,
  npc: 37,
  abilities: 28,
  rules: 29,
  era: 5,
  occurrence: 5
}
  Relationships: 1116
  Pressures: {
  resource_scarcity: 85,
  conflict: 30.994924020447325,
  magical_instability: 53.61564776543767,
  cultural_tension: 85,
  stability: 95.7495593849487,
  external_threat: 0
}

  === Distribution Statistics ===
  Entity Kinds (current vs target):
    âœ“ location: 27.4% (target: 30.0%, -2.6%)
    âš ï¸ faction: 9.1% (target: 20.0%, -10.9%)
    âœ“ npc: 22.6% (target: 20.0%, +2.6%)
    âœ“ abilities: 17.1% (target: 15.0%, +2.1%)
    âœ“ rules: 17.7% (target: 15.0%, +2.7%)
    âœ“ era: 3.0% (target: 0.0%, +3.0%)
    âœ“ occurrence: 3.0% (target: 0.0%, +3.0%)
  Prominence (current vs target):
    âœ“ forgotten: 5.5% (target: 10.0%, -4.5%)
    âš ï¸ marginal: 31.1% (target: 25.0%, +6.1%)
    âš ï¸ recognized: 36.0% (target: 30.0%, +6.0%)
    âš ï¸ renowned: 13.4% (target: 25.0%, -11.6%)
    âœ“ mythic: 14.0% (target: 10.0%, +4.0%)
  Top relationship types:
    âš ï¸ trades_with: 24.6%
    âœ“ controls: 9.3%
    âœ“ practitioner_of: 7.9%
    âœ“ believer_of: 5.4%
    âœ“ adjacent_to: 5.2%
  Graph Connectivity:
    Clusters: 23 (target: 5)
    Avg cluster size: 7.1
    Avg connections/entity: 13.6
    Isolated nodes: 22 (13.4%)

  Overall Deviation Score: 0.390
  âš ï¸  HIGH DEVIATION - template selection will be heavily guided

=== Epoch 8: The Orca Incursion ===
  âš ï¸  Template magic_discovery would oversaturate tags: mystical
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template magic_discovery would oversaturate tags: mystical
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
  Growth: +25 entities (target: 25)
  Entities by kind: {
  location: 45,
  faction: 15,
  npc: 47,
  abilities: 39,
  rules: 33,
  era: 5,
  occurrence: 5
}
  Relationships: 941
  Pressures: {
  resource_scarcity: 85,
  conflict: 44.005921222727466,
  magical_instability: 56.65206879325028,
  cultural_tension: 89.01269841269841,
  stability: 94.05789271828203,
  external_threat: 15
}

  === Distribution Statistics ===
  Entity Kinds (current vs target):
    âš ï¸ location: 23.8% (target: 30.0%, -6.2%)
    âš ï¸ faction: 7.9% (target: 20.0%, -12.1%)
    âœ“ npc: 24.9% (target: 20.0%, +4.9%)
    âš ï¸ abilities: 20.6% (target: 15.0%, +5.6%)
    âœ“ rules: 17.5% (target: 15.0%, +2.5%)
    âœ“ era: 2.6% (target: 0.0%, +2.6%)
    âœ“ occurrence: 2.6% (target: 0.0%, +2.6%)
  Prominence (current vs target):
    âœ“ forgotten: 5.3% (target: 10.0%, -4.7%)
    âš ï¸ marginal: 33.3% (target: 25.0%, +8.3%)
    âš ï¸ recognized: 38.1% (target: 30.0%, +8.1%)
    âš ï¸ renowned: 11.1% (target: 25.0%, -13.9%)
    âœ“ mythic: 12.2% (target: 10.0%, +2.2%)
  Top relationship types:
    âœ“ practitioner_of: 12.0%
    âœ“ controls: 10.8%
    âœ“ trades_with: 6.8%
    âœ“ adjacent_to: 6.2%
    âœ“ resident_of: 6.2%
  Graph Connectivity:
    Clusters: 25 (target: 5)
    Avg cluster size: 7.6
    Avg connections/entity: 10.0
    Isolated nodes: 24 (12.7%)

  Overall Deviation Score: 0.392
  âš ï¸  HIGH DEVIATION - template selection will be heavily guided

=== Epoch 9: The Orca Incursion ===
  âš ï¸  Template magic_discovery would oversaturate tags: mystical
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template magic_discovery would oversaturate tags: mystical
  âš ï¸  Template magic_discovery contract violations:
      Created 4 relationships, but contract suggests max ~3
  âš ï¸  Template crisis_legislation would oversaturate tags: emergency
  âš ï¸  Template crisis_legislation would oversaturate tags: emergency
  âš ï¸  Template crisis_legislation would oversaturate tags: emergency
  Growth: +19 entities (target: 25)
  Entities by kind: {
  location: 50,
  faction: 18,
  npc: 49,
  abilities: 41,
  rules: 40,
  era: 5,
  occurrence: 5
}
  Relationships: 1326
  Pressures: {
  resource_scarcity: 85,
  conflict: 55.10919398233136,
  magical_instability: 60.473512839974155,
  cultural_tension: 85,
  stability: 97.54058179391228,
  external_threat: 30
}

  === Distribution Statistics ===
  Entity Kinds (current vs target):
    âš ï¸ location: 24.0% (target: 30.0%, -6.0%)
    âš ï¸ faction: 8.7% (target: 20.0%, -11.3%)
    âœ“ npc: 23.6% (target: 20.0%, +3.6%)
    âœ“ abilities: 19.7% (target: 15.0%, +4.7%)
    âœ“ rules: 19.2% (target: 15.0%, +4.2%)
    âœ“ era: 2.4% (target: 0.0%, +2.4%)
    âœ“ occurrence: 2.4% (target: 0.0%, +2.4%)
  Prominence (current vs target):
    âœ“ forgotten: 6.3% (target: 10.0%, -3.8%)
    âœ“ marginal: 29.3% (target: 25.0%, +4.3%)
    âš ï¸ recognized: 39.4% (target: 30.0%, +9.4%)
    âš ï¸ renowned: 12.5% (target: 25.0%, -12.5%)
    âœ“ mythic: 12.5% (target: 10.0%, +2.5%)
  Top relationship types:
    âš ï¸ trades_with: 19.9%
    âœ“ controls: 12.5%
    âœ“ practitioner_of: 8.9%
    âœ“ adjacent_to: 5.1%
    âœ“ resident_of: 5.1%
  Graph Connectivity:
    Clusters: 34 (target: 5)
    Avg cluster size: 6.1
    Avg connections/entity: 12.8
    Isolated nodes: 33 (15.9%)

  Overall Deviation Score: 0.533
  âš ï¸  HIGH DEVIATION - template selection will be heavily guided

âœ“ All eras completed at epoch 10

âœ“ Linked final era "The Frozen Peace" to 10 prominent entities

Generation complete!
Final state: 208 entities, 1336 relationships

=== Atlas Enrichment Analytics ===
Total enrichment triggers: 304
  Locations:    185
  Factions:     91
  Rules:        7
  Abilities:    16
  NPCs:         5
  Occurrences:  0
  Eras:         0
Note: Enrichment disabled - these are detected triggers only

================================================================================
HOMEOSTATIC FEEDBACK SYSTEM - FINAL REPORT
================================================================================

ðŸ“Š FEEDBACK LOOP HEALTH
  Total loops tracked: 30
  âœ“ Working correctly: 12 (40%)
  âš ï¸  Not functioning: 18 (60%)

  Broken loops requiring attention:

  1. hero_reduces_conflict
     Wrong direction: expected negative correlation, got 0.63
     â†’ Reverse the mechanism or check if npc:hero.count actually affects conflict.value

     Detailed Analysis:
     Feedback Loop: hero_reduces_conflict
     Expected: npc:hero.count â†’ conflict.value (negative feedback)
     Problem: Wrong direction: expected negative correlation, got 0.63
     Recommendation: Reverse the mechanism or check if npc:hero.count actually affects conflict.value
     Suggested Fixes:
       1. Check if components actually implement the mechanism described
       2. Verify contract.affects declarations match actual behavior
       3. Consider inverting the feedback loop type (negative â†’ positive)

  2. instability_reduces_magic_creation
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if magical_instability.value actually affects abilities:magic.trend

     Detailed Analysis:
     Feedback Loop: instability_reduces_magic_creation
     Expected: magical_instability.value â†’ abilities:magic.trend (negative feedback)
     Problem: Wrong direction: expected negative correlation, got 0.00
     Recommendation: Reverse the mechanism or check if magical_instability.value actually affects abilities:magic.trend
     Suggested Fixes:
       1. Check if components actually implement the mechanism described
       2. Verify contract.affects declarations match actual behavior
       3. Consider inverting the feedback loop type (negative â†’ positive)

  3. anomaly_enables_magic
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if location:anomaly.count actually affects abilities:magic.count

     Detailed Analysis:
     Feedback Loop: anomaly_enables_magic
     Expected: location:anomaly.count â†’ abilities:magic.count (positive feedback)
     Problem: Wrong direction: expected positive correlation, got 0.00
     Recommendation: Reverse the mechanism or check if location:anomaly.count actually affects abilities:magic.count
     Suggested Fixes:
       1. Check if components actually implement the mechanism described
       2. Verify contract.affects declarations match actual behavior
       3. Consider inverting the feedback loop type (positive â†’ negative)

  4. magic_tech_balance
     Wrong direction: expected negative correlation, got 0.87
     â†’ Reverse the mechanism or check if abilities:magic.count actually affects abilities:technology.trend

  5. threat_triggers_orcas
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if external_threat.value actually affects npc:orca.count

  6. orca_saturation_suppresses_creation
     Wrong direction: expected negative correlation, got 0.66
     â†’ Reverse the mechanism or check if npc:orca.deviation actually affects npc:orca.trend

  7. anomaly_enables_cults
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if location:anomaly.count actually affects faction:cult.count

  8. cult_increases_instability
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if faction:cult.count actually affects magical_instability.value

  9. tension_triggers_splinters
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if cultural_tension.value actually affects faction:political.count

  10. scarcity_triggers_exploration
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if resource_scarcity.value actually affects location:geographic_feature.count

  11. resources_reduce_scarcity
     Wrong direction: expected negative correlation, got 0.75
     â†’ Reverse the mechanism or check if location:geographic_feature.count actually affects resource_scarcity.value

  12. enemies_drive_conflict
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if enemy_of.count actually affects conflict.value

  13. alliances_reduce_conflict
     Too weak: expected |correlation| >= 0.2, got 0.02
     â†’ Increase feedback strength from -0.4 to -0.60

  14. succession_reduces_stability
     Wrong direction: expected negative correlation, got 1.00
     â†’ Reverse the mechanism or check if npc:mayor.count actually affects stability.value

  15. stability_reduces_splinters
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if stability.value actually affects faction:political.trend

  16. relationship_decay
     Wrong direction: expected negative correlation, got 0.57
     â†’ Reverse the mechanism or check if enemy_of.count actually affects enemy_of.trend

  17. rules_reduce_tension
     Wrong direction: expected negative correlation, got 0.00
     â†’ Reverse the mechanism or check if rules:social.count actually affects cultural_tension.value

  18. tension_triggers_ideology
     Wrong direction: expected positive correlation, got 0.00
     â†’ Reverse the mechanism or check if cultural_tension.value actually affects rules:social.count

     ... and 15 more broken loops
     Use printDetailedDiagnostics() for full analysis

ðŸ“ˆ POPULATION METRICS
  Total entities: 208
  Total relationships: 1345
  Average deviation from targets: 0.0%
  Maximum deviation: 0.0%

ðŸŽ¯ ENTITY POPULATIONS (vs targets)

ðŸŒ¡ï¸  PRESSURE EQUILIBRIUM
  âŒ resource_scarcity       85.0/   30 (+183%)
  âš ï¸ conflict                55.1/   40 (+38%)
  âŒ magical_instability     60.5/   25 (+142%)
  âŒ cultural_tension        85.0/   35 (+143%)
  âŒ stability               97.5/   60 (+63%)
  âŒ external_threat         30.0/   15 (+100%)

ðŸ“‹ TEMPLATE USAGE (Diversity Report)
  Total template applications: 156
  Unique templates used: 17/22

  Top templates by usage:
    ðŸŸ¡ crisis_legislation                   16x (10.3%)
    ðŸŸ¡ emergent_location_discovery          16x (10.3%)
    ðŸŸ¢ ideology_emergence                   13x (8.3%)
    ðŸŸ¢ succession                           12x (7.7%)
    ðŸŸ¢ tech_breakthrough                    11x (7.1%)
    ðŸŸ¢ magic_discovery                      11x (7.1%)
    ðŸŸ¢ magical_site_discovery               10x (6.4%)
    ðŸŸ¢ great_festival                        9x (5.8%)
    ðŸŸ¢ anomaly_manifestation                 9x (5.8%)
    ðŸŸ¢ orca_combat_technique                 9x (5.8%)

  âš ï¸  Unused templates (5) - Diagnostic Analysis:
    â€¢ hero_emergence                     
      Contract: âœ“ | Saturation: All entity kinds saturated: npc:hero (10/5) | canApply(): âœ“ | Targets: 5
    â€¢ faction_splinter                   
      Contract: âœ“ | Saturation: âœ“ | canApply(): âœ— | Targets: 0
    â€¢ territorial_expansion              
      Contract: âœ“ | Saturation: âœ“ | canApply(): âœ“ | Targets: 10
    â€¢ trade_route_establishment          
      Contract: âœ“ | Saturation: âœ“ | canApply(): âœ“ | Targets: 18
    â€¢ resource_location_discovery        
      Contract: âœ“ | Saturation: âœ“ | canApply(): âœ— | Targets: 4

ðŸ¥ OVERALL SYSTEM HEALTH: 70%
  Feedback loops: 40%
  Population control: 100%
  âš ï¸  System is FUNCTIONAL - some tuning needed

=== TAG HEALTH SUMMARY ===

COVERAGE:
  Total entities: 208
  With tags: 208 (100.0%)
  Optimal (3-5 tags): 141 (67.8%)

DIVERSITY:
  Unique tags: 79
  Shannon index: 3.874
  Evenness: 0.887 (target: >0.6)

ISSUES:
  Orphan tags: 30
  Overused tags: 2
  Tag conflicts: 0
  Consolidation opportunities: 0

ENTITY ISSUES:
  Undertagged (<3 tags): 65
  Overtagged (>5 tags): 2

RECOMMENDATIONS:
  - Only 67.8% of entities have optimal tag count (3-5 tags). Target: 70%+. 65 entities need more tags.
  - 30 orphan tags detected (used < minUsage). Consider: (1) increasing their usage, (2) removing them, or (3) adjusting minUsage thresholds.
  - 2 tags exceed maxUsage. Top offender: "mystical" (49/35). Consider raising maxUsage or reducing template frequency.

ORPHAN TAGS (used < minUsage):
  icy                            (1/3)
  landmark                       (1/3)
  multilevel                     (1/3)
  trading                        (1/3)
  peaceful                       (1/3)
  unified                        (1/3)
  food                           (1/3)
  strategic                      (1/3)
  windy                          (1/3)
  vantage                        (1/3)
  charismatic                    (1/3)
  expansion                      (1/3)
  invasion                       (1/3)
  reconstruction                 (1/3)
  prosperity                     (1/3)
  exploration                    (1/3)
  neutral                        (1/3)
  fertile                        (1/3)
  governance                     (1/3)
  legislative                    (1/3)
  political                      (1/3)
  equality                       (1/3)
  glowing                        (2/3)
  war:111                        (2/3)
  war:71                         (2/3)
  leader                         (2/3)
  brave                          (2/3)
  fishing                        (2/3)
  meta-entity                    (2/3)
  harvest                        (2/3)

OVERUSED TAGS (exceeding maxUsage):
  mystical                       (49/35)
  emergency                      (18/15)
================================================================================

âš ï¸  Warnings logged to: output/warnings.log
Generation Time: 4.655s

=== WORLD VALIDATION ===
Total Checks: 5
Passed: 4 âœ“
Failed: 1 âœ—

âœ— Connected Entities
   1 entities have no connections:
  - occurrence:economic_boom: 1

Sample unconnected entities:
  - The Fortune Era (occurrence:economic_boom, created tick 0)

âœ“ Entity Structure
âœ“ Relationship Integrity
âœ“ Link Synchronization
âœ“ Lore Presence

=== FINAL STATISTICS ===
Total Entities: 208
Total Relationships: 1303
Simulation Ticks: 150
Epochs Completed: 10

=== ENTITY BREAKDOWN ===
  abilities:combat: 9
  abilities:magic: 12
  abilities:technology: 20
  era:conflict: 1
  era:expansion: 1
  era:innovation: 1
  era:invasion: 1
  era:reconstruction: 1
  faction:company: 8
  faction:criminal: 1
  faction:cult: 8
  faction:political: 1
  location:anomaly: 30
  location:colony: 5
  location:geographic_feature: 14
  location:iceberg: 1
  npc:hero: 10
  npc:mayor: 14
  npc:merchant: 16
  npc:orca: 9
  occurrence:economic_boom: 1
  occurrence:war: 4
  rules:edict: 5
  rules:social: 27
  rules:taboo: 8

=== CATALYST ACTIONS ===
  Active agents: 14
  Agent actions: 345
  Top agents by actions:
    Harmonic: 63 actions
    The Icebound: 60 actions
    The Midnight: 55 actions
    High-Beak: 50 actions
    Shadow-Broker: 44 actions

=== RELATIONSHIP TYPES ===
  trades_with: 264
  controls: 166
  practitioner_of: 118
  adjacent_to: 68
  resident_of: 68
  member_of: 59
  manifests_at: 58
  active_during: 50
  inspired_by: 45
  derived_from: 43

=== SAMPLE HISTORY EVENTS ===
  [Tick 147] The The Midnight Claws-Circle of the Depths War drew West Perch Exchange into the war
  [Tick 147] Systems: +6 relationships, 11 modifications
  [Tick 148] The Midnight Claws established trade route between Driftkeeper Krill Grounds and Driftbeak Krill Grounds
  [Tick 148] High-Beak Auditor Selka established trade route between West Roost and Floewatcher Krill Grounds
  [Tick 148] Shadow-Broker Nyla seized control of Krill Shoals
  [Tick 148] The The Midnight Claws-Circle of the Depths War drew Circle of the Depths into the war
  [Tick 148] Systems: +6 relationships, 12 modifications
  [Tick 149] The Midnight Claws raided Order of the Depths
  [Tick 149] High-Beak Auditor Selka established trade route between Ethereal Shelf and The Frozen Aurora
  [Tick 149] Systems: +3 relationships, 11 modifications

=== NOTABLE ENTITIES ===
  Aurora Stack (location:colony) - mythic
    "A vertical colony carved into the sunlit face of Aurora Berg, known for orderly terraces and bright trade banners."
  Nightfall Shelf (location:colony) - mythic
    "A shadowed ledge on the far side of Aurora Berg, lit by bioluminescent ice glyphs and whispered deals."
  Krill Shoals (location:geographic_feature) - mythic
    "Dense drifting clouds of krill that pass regularly beneath Aurora Stack, the lifeblood of its fisheries."
  The Glow-Fissure (location:anomaly) - mythic
    "A deep crack in the ice under Nightfall Shelf that pulses with otherworldly light and warps the currents."
  Windward Ridge (location:geographic_feature) - renowned
    "A knife-edge crest of ice where the high winds carve strange patterns and carry news between colonies."
  The Icebound Exchange (faction:company) - mythic
    "A merchant guild that monopolizes trade through Aurora Stack, issuing carved-ice credit chits and regulating fish prices."
  The Midnight Claws (faction:criminal) - renowned
    "A clandestine syndicate ruling Nightfall Shelf from the shadows, smuggling forbidden tech and siphoning magic from the Glow-Fissure."
  High-Beak Auditor Selka (npc:mayor) - mythic
    "The meticulous mayor of Aurora Stack, famed for balancing ledgers as easily as she balances on sheer ice walls."
  Tide-Splitter Rukan (npc:hero) - renowned
    "A daring super-penguin hero of Aurora Stack, whose experimental fishing gun techniques doubled the colony's catch."
  Shadow-Broker Nyla (npc:mayor) - mythic
    "The unofficial mayor of Nightfall Shelf, a veiled negotiator who settles disputes before anyone admits they exist."

âœ… World state exported to ./output/generated_world.json
âœ… Graph visualization exported to ./output/graph_viz.json
âœ… Lore output exported to ./output/lore.json (disabled)
âœ… Statistics exported to ./output/stats.json
